# 正则获取文件名

- 文件后缀

  ```
  'https://www.cnblogs.com/qiao20/p/6248510.html'.replace(/.+\./,"");
  ```

  

- 包括后缀

  ```
  'https://www.cnblogs.com/qiao20/p/6248510.html'.replace(/(.*\/)*([^.]+)/i,"$2");
  ```

  

- 不包括后缀

  ```
  'https://www.cnblogs.com/qiao20/p/6248510.html'.replace(/(.*\/)*([^.]+).*/i,"$2");
  ```

# loading效果

[10种loading效果](https://www.jianshu.com/p/b22cbc1c6c40)

# 数组去重

```
function uniqueArray(arr, key) {
    let result = []
    let obj = {}

    for (let i of arr) {
        if (!obj[i]) {
            result.push(i)
            obj[i] = 1
        }
    }

    return result
}
```



# 手机号掩码

```
phone.replace((\d{3})\d{4}(\d{4}), "$1****$2")
```



# momentJS 计算日期差*天

[api](http://momentjs.cn/docs/#/displaying/difference/)

```
var a = moment([2007, 0, 29]);
var b = moment([2007, 0, 28]);
a.diff(b, 'days') // 1
```



# 2行…

```
	text-overflow: -o-ellipsis-lastline;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
	word-break:break-all;
```



# Fetch

[api](https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch)



# js url传递数组

```
JSON.stringify([1,2,3])
```



# 判断string是字符串 or json串

```
function isJSON(str) {
    if (typeof str == 'string') {
        try {
            JSON.parse(str);
            return true;
        } catch(e) {
            console.log(e);
            return false;
        }
    }
    console.log('It is not a string!')    
}
```



# JS 判断是否是微信浏览器

```
var isWeixin = function () { //判断是否是微信
    var ua = navigator.userAgent.toLowerCase();
    return ua.match(/MicroMessenger/i) == "micromessenger";
};
```



# 页面title更改

```
document.tiltle = "你好"
```



# 页面来源refer(防盗链)

```
document.referrer
```



# 创建指定length的数组

//es6

```
Array.from({length: 4})
```



# 滚动加载更多

[代码](https://codesandbox.io/embed/microtask-n6q94)



# 浮点数计算解决精度问题

```
// 浮点数计算
  accFloat: function(op, arg1, arg2) {
    var s1 = arg1.toString()
    var s2 = arg2.toString()

    var digits1 = (s1.split('.')[1] || '').length
    var digits2 = (s2.split('.')[1] || '').length
    const baseNum = Math.pow(10, Math.max(digits1, digits2));

    let num1 = parseInt((s1 * baseNum).toFixed(0));
    let num2 = parseInt((s2 * baseNum).toFixed(0));

    let result = 0

    switch (op) {
      case '+':
        result = (num1 + num2) / baseNum
        break;

      case '-':
        result = (num1 - num2) / baseNum
        break;

      case '*':
        result = (num1 * num2) / (baseNum*baseNum)
        break;  

      default:
        break;
    }
    return result 
  }
```



# 对象深拷贝

```
//方法一 
//数组
JSON.parse(JSON.stringify([]))
//对象
JSON.parse(JSON.stringify({}))
```

```
//方法二
function isObject(obj) {
    return typeof obj === 'object'
}

function deepClone(obj) {
    if (!isObject(obj)) {
        throw new Error('obj 不是一个对象！')
    }

    let isArr = isArray(obj)
    let cloneObj = isArr ? [] : {}
    for (let key in obj) {
        cloneObj[key] = isObject(obj[key]) ? deepClone(obj[key]) : obj[key]
    }

    return cloneObj
}
```



# 节流和防抖

[节流和防抖的区别，以及如何实现](https://www.jianshu.com/p/b5fcb9a04b17)



# 防暴力点击

```
function throttle(fn, interval, timeout) {
    var _t = new Date().getTime(),
        _timeout;
    return function handler() {
        var t = new Date().getTime();
        _timeout && clearTimeout(_timeout);
        if (t - _t >= timeout) {
            _t = new Date().getTime();
            fn.apply(this, arguments);
        } else {
            _timeout = setTimeout(handler.bind(this), interval);
        }
    };
}
function debounce(fn, interval) {
    var flag = true
    var _t
    return function() {
      flag && (fn.apply(this, arguments), (flag = false))
      _t && clearTimeout(_t)
      _t = setTimeout(function() {
        flag = true
      }, interval)
    }
  }
```

使用

```
handleTab: utils.debounce(function(e){}, 500)
```



# url上的查询条件转为Object对象

```
function getUrlSearchObj(url) {
	var obj = {};
	if(url) {
	  url = url.replace(/#[^#]*$/, "");
		var index = url.indexOf("?");
		if(index != -1) {
			var queryStr = url.substr(index + 1);
			var marchResult = null;
			var regex = /(\w+)(=([^&#]+)?)?/g;
			while((marchResult = regex.exec(queryStr)) != null) {
				if(marchResult[1] in obj) {
					var values = obj[marchResult[1]];
					if(values instanceof Array) {
						values.push(marchResult[2] ? (marchResult[3]?marchResult[3]:"") : null);
						obj.marchResult[1] = values;
					} else {
						var arr = [];
						arr.push(values);
						arr.push(marchResult[2] ? (marchResult[3]?marchResult[3]:"") : null);
						obj[marchResult[1]] = arr;
					}
				} else {
					obj[marchResult[1]] = marchResult[2] ? (marchResult[3]?marchResult[3]:"") : null;
				}
			}
		}
	}
	return obj;
}
```

# Object对象转为url上的查询条件

```
Object.keys(obj)
        .reduce((pre, cur) => `${pre}${cur}=${obj[cur]}&`, "?")
        .replace(/&$/, "");
```

